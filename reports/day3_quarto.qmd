---
title: "My document"
format:
  html:
    toc: true
    number-sections: true
execute: 
  echo: false
---




# Introduction



## Problem Statement

## Research Gaps

## Objectives

1. What is the prevalence of hypertension among adults in the district?

2. What is the prevalence of diabetes among adults in the district?

3. What is the average blood sugar of adult males?

4. What is the prevalence of anaemia among girls under 18 years?

5. What is the average BMI of the study population?



# Methods

## Data Source


 Data for the Clinical Anthropometric and Biochemical Survey 2014

<https://data.gov.in/search?title=cab%20survey>

## Details about the CAB Survey
- Height/length and weight of all members of the household,
  women, men and children aged 1 month and above,
- Hb estimation of women, men and children aged 6 months and above,
- Blood pressure of all members of the household aged 18 years and above,
- Fasting blood glucose levels in all members of the household aged 18 years and above.
- Household salt testing for iodine content to assess access to iodised salt.
- In addition information on physiological status of woman, infant and
  young child feeding practices and morbidity at the time of survey was to be collected
  to correlate these factors with the nutritional status of the persons surveyed

# Results

## Prevalance of Hypertension

```{r}
#| echo: false
#| warning: false
#| message: false

# load pacakges

library(tidyverse)  # for additional packages for tidy operations
library(here)       # for organising file paths
library(rio)        # for importing data
library(gtsummary)
library(gt)

# load data


## Create path to the file to read

filepath <- here("data", "ahs-cab2014-chhattisgarh-bastar(1).csv")

## Import data using the `import` function, set class as `tibble`
df <- import(filepath, setclass = "tibble")

# clean variable names
df <-
  df |>
  janitor::clean_names()

# create age in years
df <-                 # Step 6: reassign it back to `df` to save
 df |>                # Step 1: specify dataset
  mutate(age_in_years =           # Step 2: specify the name of the new column
           case_when(             # Step 3: use the `ifelse` function
             age_code == "Days" ~ age/365,     # Step 4a: change age in days
             age_code == "Months" ~ age/12,    # Step 4b: change age in months
             age_code == "Year" ~ age,         # Step 4c: keep age if age_code is  years
             TRUE ~ NA                # Step 5: for the rest, keep as NA
             ))


df <-                    # Step 6: reassign it back to `df` to save
  df |>                  # Step 1: specify dataset
  mutate(age_cat =           # Step 2: specify the name of the new column
           case_when(        # Step 3: use the `ifelse` function
             age_in_years <= 5 ~ "Under 5 years",        # Step 4a: specify under 5 years
             age_in_years < 18 ~ "Under 18 years",       # Step 4b: 5-18 years
             age_in_years >= 18 ~ "18 years and above",  # Step 4c: 18+ years
             TRUE ~ NA                        # Step 5: for the rest, keep as NA
           )
  )
# create systolic and diastolic means
df <- 
  df |>
  mutate(
    bp_systolic_mean = (bp_systolic + bp_systolic_2_reading)/2 , # Step 2: calculate mean systolic BP
    bp_diastolic_mean = (bp_diastolic + bp_diastolic_2reading)/2 # Step 3: calculate mean diastolic BP
  )

# Create hypertension category
df <-         #  Step 7: reassign it back to `df` to ensure the changes are saved
  df |>       # Step 1: specify dataset
  mutate( hypertension =       # Step 2: specify the name of the new column
            if_else(            # Step 3: use the `ifelse` function
              bp_systolic_mean >= 140 | bp_diastolic_mean >= 90,     # Step 4: specify the condition
              "Present",                    #  Step 5: specify if true
              "Absent"                      #  Step 6: specify if false
              )) |>
  mutate(hypertension = factor(hypertension))

```

## Distribution of hypertenison

```{r}
#| echo: false
#| warning: false
#| message: false

df %>% 
  ggplot(aes(x = bp_systolic_mean, y = bp_diastolic_mean, color = rural_urban)) +
  geom_point(alpha = 0.05) +
  geom_smooth(method = 'lm', alpha= 0.8)
```

```{r}
#| echo: false

df %>% 
  filter(age_in_years >= 18) %>% 
  count(hypertension) %>% 
  drop_na(hypertension) %>% 
  reframe(hypertension, n, prev = round((n/sum(n))*100,2)) %>% 
  gt::gt() %>% 
  tab_header(
    title = "The prevalance of Hypertension among Adult Poulation",
    subtitle = "The data from CAB Survey 2014 (https://data.gov.in/search?title=cab%20survey)"
  )
```
4. What is the prevalence of anaemia among girls under 18 years?

```{r}

df <- df |>
  mutate(anaemia_cat =
           if_else(haemoglobin_level <= 10, "Present", "Absent"))


df %>% 
  filter(age_in_years < 18) %>% 
  # filter(sex == "Female") %>% 
  select(anaemia_cat, sex) %>% 
  gtsummary::tbl_summary(by = sex, missing  = 'no') %>% 
  add_p()

```


5. What is the average BMI of the study population?


```{r}
df <- df |>
  mutate(bmi = weight_in_kg/(length_height_cm/100)^2
           )

df <- df %>% 
  mutate(bmi = ifelse(bmi >= 40, 40, bmi))
```

```{r}
df %>% 
  summarize(mean_BMI = mean(bmi, na.rm = T))
```


```{r}
df %>% 
  select(bmi, sex) %>% 
  tbl_summary(
    by = sex,
    statistic = list(all_continuous() ~ "{mean}, ({sd})"),
    missing = 'no'
  ) %>% 
  add_p()

```


## Create a boxplot 

```{r}
df %>% 
  ggplot() +
  geom_boxplot(aes(y = bmi, fill = sex))


df %>% 
  ggplot() +
  geom_histogram(aes(x = bmi, fill = sex), alpha = 0.5)
```


# Discussion

# References



