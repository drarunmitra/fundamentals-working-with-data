---
title: "Quarto Group Activity: Day 3"
code-fold: true
editor_options: 
  chunk_output_type: console
---




# About the Dataset

The dataset contains information on the deaths due to COVID-19 in 14 districts of Kerala state. This information is available for download from the Government of Kerala COVID-19 Dashboard (<https://dashboard.kerala.gov.in/covid/>



## 1. Load packages

Load packages `tidyverse`, `here`, and `rio`.

::: {.callout-caution collapse="true"}

### Answer

```{r}
#| code-fold: true
#| warning: false

library(tidyverse)
library(here)
library(rio)
library(gtsummary)
```

:::



## 2. Import the Data

Import the dataset using `rio` package.

::: {.callout-caution collapse="true"}

### Answer

```{r}

# define file path
df_path<- here::here("data","kerala_covid_deaths.rds")

# read data
df <- rio::import(here(df_path))
```

:::



## 3. Are the names of the dataset clean? If not, clean them.

hint:snake_case


::: {.callout-caution collapse="true"}

### Answer

```{r}


df <- df %>% 
  janitor::clean_names()

names(df)
```

:::

## 4. Check the class and structure of the dataset

Hint: Explore different functions like `class`, `str`.

::: {.callout-caution collapse="true"}

### Answer

```{r}


df %>% 
  class()

df %>% 
  str()

```

:::

## 5. Remove the variables not necessary for the analysis

"sl_no", "name", "place", "history_traveler_contact"

Hint: `select()` could be used.

::: {.callout-caution collapse="true"}

### Answer

```{r}


df <- df %>% 
  select(-c("sl_no", "name", "place", "history_traveler_contact"))

view(df)
```

:::



## 6. Describing the dataset

Write an R code to look at the number of rows and columns.

Hint: explore `nrow()`, `ncol()`, `glimpse()`

::: {.callout-caution collapse="true"}

### Answer

```{r}

df %>% 
  dim()

df %>% 
  nrow()

df %>% 
  ncol()

df %>% 
  glimpse()

df %>% as_tibble()

```

:::



## Give quick summary of the dataset

Hint: `glimpse`, `skimr::skim()`, `tbl_summary()`

::: {.callout-caution collapse="true"}

### Answer

```{r}


df %>% 
  glimpse()


df %>% 
  skimr::skim()

df %>% 
  tbl_summary()


```

:::



## What are the different types of variables in the dataset

::: {.callout-caution collapse="true"}

### Answer

```{r}


# What does the above output tell you?
class(df)

as_tibble(df)
```

:::



## How many districts are there?

::: {.callout-caution collapse="true"}

### Answer

```{r}

df %>% 
  distinct(district)

df %>% 
  count(district)


```

:::



## How many deaths occurred in each district?

Hint: `count()` ,`arrange()`, `group_by()` ,`summarise()`

::: {.callout-caution collapse="true"}

### Answer

```{r}

df %>% 
  count(district) %>% 
  arrange(n)

deaths_df <- df %>% 
  group_by(district) |> 
  summarise(deaths = n())


```

:::



## According to this dataset, when did the maximum number of deaths occur?

::: {.callout-caution collapse="true"}

### Answer

```{r}

 df %>% 
  count(date_reported) %>% 
  arrange(-n) 
```

:::



## Which are the top five districts in COVID-19 deaths?

Hint: Explore `slice()`

::: {.callout-caution collapse="true"}

### Answer


```{r}

df %>% 
  count(district) %>% 
  arrange(-n) %>% 
  slice(1:5)
```


:::

## Is there a delay between death and reporting of death?

If yes, how many days is the delay?

Hint: use mutate() to substract the relevant variables from each other, you can try the mean() function

::: {.callout-caution collapse="true"}

```{r}

# Hint: use mutate() to substract the relevant variables from each other, you can try the mean() function
df %>% 
  mutate(
    delay = date_reported - date_of_death) %>%
  pull(delay) %>% 
  mean(na.rm = T) %>% 
  round(1)
```
 
:::



## Is this delay same across all the districts?

::: {.callout-caution collapse="true"}

### Answer

```{r}

df %>% 
  mutate(
    delay = date_reported - date_of_death) %>%
  group_by(district) %>%
  summarize(
    mean_delay = mean(delay, na.rm = T))
```

:::



## Create a new categorical variable representing age as a dichotomous variable

::: {.callout-caution collapse="true"}

### Answer

```{r}
df <- df %>% 
  mutate(
    age_group = 
      ifelse(
        age <= 60, "<60 Years",">60 Years"))

view(df)
```

:::



## Create a new categorical variable representing the Wave of COVID

Use a cut off of 2021-04-01

::: {.callout-caution collapse="true"}

### Answer

```{r}
df <- df %>% 
  mutate(
    wave = ifelse(
      date_of_death <= "2021-04-01", "First Wave", "Second Wave"))  


```

:::



## Creating Chloropath Map

### `sf` package

::: {.callout-caution collapse="true"}

### Answer

```{r}
library(sf)
```

:::

###  creating sf object

::: {.callout-caution collapse="true"}

### Answer

```{r}

kerala_dist_sf <- rio::import(here("data", "kerala_district_sf.rds"))

class(kerala_dist_sf)

deaths_df <- deaths_df |> 
  mutate(district = case_when(district == "Kasaragod" ~ "Kasargod",
                              district == "Kozhikode" ~ "Kozhikkode", 
                              T ~ district
                              ))

deaths_sf <- kerala_dist_sf |> 
  left_join(deaths_df)
```

:::

### Ploting Map

::: {.callout-caution collapse="true"}

### Answer

```{r}
deaths_sf <- st_as_sf(deaths_sf)

deaths_sf |> 
  ggplot() +
  geom_sf(aes(fill = deaths)) +
  scale_fill_distiller(palette = "Spectral")

```

:::

|             |
|-------------|
| ASSIGNMENTS |

------------------------------------------------------------------------


#### What are distribution of deaths across time?

> Answer:



#### Visualize mortality of COVID-19 in Kerala in different districts

::: {.callout-caution collapse="true"}

##### Answer:

```{r}

df %>% 
  ggplot() +
  geom_bar(aes(x = district))
              
```

:::


#### Which are the high burden district? Does these districts remain the same in both the COVID waves? Comment.

> Answer:

#### Is there an association between COVID-19 deaths and the waves of COVID?

> Answer:

```{r}

              
```

#### Prepare an appropriate plot to visualise this relationships.

> Answer:
```{r}

```

:::

#### Which statistical tests should be applied here?

> Answer:

#### Please make a summary table using gtsummary for the same?

> Answer:

#### Interpret the findings

> Answer:

|                                                                   |
|-------------------------------------------------------------------|
| \# MEGA BONUS points if you use inline code to achieve this task! |

